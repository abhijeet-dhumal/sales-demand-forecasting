# OpenShift AI Model Registry
# Provides versioned model storage with REST/gRPC APIs for KServe integration
# NOTE: Must be deployed in rhoai-model-registries namespace (RHOAI requirement)
---
# Password secret for Model Registry database
apiVersion: v1
kind: Secret
metadata:
  name: model-registry-db-secret
  namespace: rhoai-model-registries
type: Opaque
stringData:
  password: feast123
---
# Model Registry CR - uses existing PostgreSQL (cross-namespace)
apiVersion: modelregistry.opendatahub.io/v1beta1
kind: ModelRegistry
metadata:
  name: sales-model-registry
  namespace: rhoai-model-registries
spec:
  # Use existing PostgreSQL (shared with Feast)
  postgres:
    host: feast-postgres.feast-trainer-demo.svc.cluster.local
    port: 5432
    database: model_registry
    username: feast
    passwordSecret:
      name: model-registry-db-secret
      key: password
    skipDBCreation: false  # Let operator create the database
  # gRPC API (required)
  grpc:
    port: 9090
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi
  # REST API with OpenShift Route
  rest:
    port: 8080
    serviceRoute: enabled  # Creates OpenShift Route for external access
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

