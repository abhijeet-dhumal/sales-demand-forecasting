%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#e3f2fd', 'primaryTextColor': '#1a1a1a', 'primaryBorderColor': '#1976d2', 'lineColor': '#455a64'}}}%%
flowchart TB
    subgraph Notebook["üìì 01-feast-features.ipynb"]
        direction TB
        
        subgraph Data["1Ô∏è‚É£ Data Preparation"]
            D1["Generate Synthetic<br/>Sales Data"]
            D2["Add Lag Features<br/>(104 weeks √ó 10 stores √ó 5 depts)"]
            D3["Save as Parquet<br/>/shared/data/"]
        end
        
        subgraph Define["2Ô∏è‚É£ Feature Definition"]
            F1["Define Entities<br/>(store, department)"]
            F2["Create Feature Views<br/>(sales_features, store_features)"]
            F3["Define Feature Services<br/>(training, inference)"]
        end
        
        subgraph Register["3Ô∏è‚É£ Register & Materialize"]
            R1["feast apply<br/>(register to PostgreSQL)"]
            R2["feast materialize<br/>(sync to online store)"]
        end
    end

    subgraph Infra["Infrastructure"]
        Ray["‚ö° Ray Cluster<br/>(distributed sync)"]
        PG[(PostgreSQL<br/>Online Store)]
        PVC[(Parquet Files<br/>Offline Store)]
    end

    D1 --> D2 --> D3
    D3 --> F1
    F1 --> F2 --> F3
    F3 --> R1 --> R2

    D3 --> PVC
    R1 --> PG
    R2 -.->|"big data"| Ray
    Ray --> PG

    Output["‚úÖ Features ready for<br/>Training & Inference"]
    R2 --> Output

    style Notebook fill:#e3f2fd,stroke:#1976d2,color:#1a1a1a
    style Data fill:#e8f5e9,stroke:#388e3c,color:#1a1a1a
    style Define fill:#fff3e0,stroke:#f57c00,color:#1a1a1a
    style Register fill:#f3e5f5,stroke:#7b1fa2,color:#1a1a1a
    style Infra fill:#eceff1,stroke:#607d8b,color:#1a1a1a

